<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../lib/swiper/css/swiper.min.css">
    <link rel="stylesheet" href="../css/detail.css">
</head>

<body>

    <script src="../lib/jquery/dist/jquery.min.js"></script>
    <script src="../lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="../lib/swiper/js/swiper.min.js"></script>
    <div class="detail">
        <div class="detail-con">
            <div class="detail-top">
                <a href="">首页</a>
                &nbsp;>&nbsp;
                <a href="">手机</a>
                &nbsp;>&nbsp;
                <a href="">HUAWEI Mate系列</a>
                &nbsp;>&nbsp;
                <span>ffffffffff</span>
            </div>
            <div class="dt-main">
                <div class="m-left">
                    <div class="photo-container">
                        <div class="pt-c">
                         <img src="https://res.vmallres.com/pimages//product/6901443376506/group//428_428_D2220091A813A89EE682B2512E3B24E290479346AB6E8D71.png"
                            alt="">
                          <div class="ydfk"></div> 
                        </div>
                        <div class="pt-datu">
                               <img src=" https://res.vmallres.com/pimages//product/6901443376506/group//800_800_D2220091A813A89EE682B2512E3B24E290479346AB6E8D71.png" alt="">
                        </div>
                        

                       
                    </div>
                    
                    <div class="pt-bottom">
                        <a href="javascript:;" class="product-gallery-back" onclick="ec.product.imgSlider.prev()"></a>
                        <!--不可点击添加class="disabled"-->
                        <div class="product-gallery-thumbs">
                            <ul id="pro-gallerys" style="left: 0px;">
                                <li class="">
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/78_78_5A4871DB483B6E0D92CA527C3D367A6A32E2B433F5870412mp.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li class="">
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_A2AB9EC13852D95C5C1C6619D7661E1E006477D18FF0269E.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li class="">
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_12F18330CB283672F16B16EC03B87883778D6B38E5850436.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li class="current">
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_3824BC7712A9FC3338E1C77A3896BCB9EEEE9AB72D00DDA7.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li class="">
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_D2220091A813A89EE682B2512E3B24E290479346AB6E8D71.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li>
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_D59D99CA592859DC8D4C0D0F98DB1EEF397A934CB8BD922A.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li>
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_A80B2DC6FAB54667AE2B5403AE8D6AAF1F5B34C8B1A7FD49.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                                <li>
                                    <a href="javascript:;">
                                        <img src="https://res.vmallres.com/pimages//product/6901443376506/group//78_78_26BE501D5183F9F7D60BC2034885F5D4C6DD16D6D856380C.png"
                                            alt="HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）">
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <a href="javascript:;" class="product-gallery-forward" onclick="ec.product.imgSlider.next()"></a>
                    </div>
                </div>
                <div class="m-right">
                    <h1 id="pro-name">HUAWEI Mate Xs 5G全网通 8GB+512GB（星际蓝）</h1> 
                    <div class="product-slogan" id="skuPromWord" style="display: block;"><a href="javascript:;" class="product-slogan-btn" style="display: none;"></a> <span class="product-slogan-link">①购机赠半价换屏服务 ②下方保障选项中可选购碎屏服务宝</span> <span>鹰翼式折叠设计|麒麟990 5G旗舰芯片|8英寸可折叠全面屏</span></div> 
                    
                    <div class="pro-info">
                        <div class="price">
                            <div>价&nbsp;&nbsp;&nbsp;格</div>
                            <div><span>￥16999.00</span></div>
                        </div>
                        <div class="chuxiao">
                            <div class='cx-l'>促&nbsp;&nbsp;&nbsp;销</div>
                            <div class="cx-r"></div>
                        </div>
                    </div>

                    <div class="fuwu">
                        <label for="">服务说明</label>
                        <ul>
                        <li>已满48元已免运费</li>
                       <li>由华为商城负责发货，并提供售后服务</li>
                    </ul>
                    </div>
                    
                    <div class="sp-id">
                     <label>商品编码</label>
                        <div class="fl" id="pro-sku-code2">2601010181301</div>
                              
                    </div>
                    <div class="xinxi">

                    </div>
                    <div class="btn-gouwu">
                        <div class="btn-g-l">
                            <input type="text">
                            <p>
                                <a href="">+</a><a href="">-</a>
                            </p>
                        </div>
                        <div class="btn-g-r">
                            <a href="">加入购物车</a><a href="">立即下单</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    //渲染页面
        var info= JSON.parse(localStorage.getItem('goods_info'))
        info.isSelect = true
        console.log(info)
        if(!info){
            location.href='./list.html'

        }else{
            $('.detail-top>span').text(info.briefName)
        $('.product-slogan>span:nth-of-type(2)').text(info.skuName)
        $('.price>div:nth-child(2)>span').text('￥'+info.price)
        $('.sp-id>div').text(info.skuCode)
        }
        
        $('.btn-g-l>input').val(1)
        info.number=1
        localStorage.setItem('goods_info',JSON.stringify(info))
        //点击数量加减
        $('.btn-g-l>p>a:nth-child(1)').click(()=>{
              info.number++;
                $('.btn-g-l>input').val(info.number)
                localStorage.setItem('goods_info',JSON.stringify(info))
        })
        $('.btn-g-l>p>a:nth-child(2)').click(()=>{
              info.number--;
              if(info.number<=1){
                info.number=1
                $('.btn-g-l>input').val(1)
                localStorage.setItem('goods_info',JSON.stringify(info))
              }else{
                $('.btn-g-l>input').val(info.number)
                localStorage.setItem('goods_info',JSON.stringify(info))
              }
                
                
        })

        //点击购物车

        $('.btn-g-r>a:nth-child(1)').click(() => {
      
      const cartList = JSON.parse(localStorage.getItem('cartList')) || []

      // 象数组里面把本条数据添加进去
      // 4-4. 判断有没有这个数据
      //      每一个数据都有一个自己的 id
      //      只要看数组里面有没有 id 一样的数据, 就知道有没有这个数据了
      //      数组常用方法有一个叫做 some 的方法
      //      返回值:
      //        true: 表示数组里面有这个信息
      //        false: 表示数组里面没有这个信息
      let exits = cartList.some(item => {
        // 数组里面每一个的 id === 本页面的这条数据的 id
        return item.productId === info.productId
      })
    //console.log(exits)
      // console.log(exits)
      if (exits) {
        // 表示有这个信息了, 我们要让 number ++
        // console.log('已经存在 number ++')
        // 找到这个信息给他 number ++
        let data = null
        for (let i = 0; i < cartList.length; i++) {
          if (cartList[i].productId === info.productId) {
            // data = cartList[i]
            //cartList[i].number++
            //data=info
            //cartList[i]=JSON.parse(localStorage.getItem('goods_info'))
            var num1=cartList[i].number+=info.number
            data=cartList[i]
            data.isSelect=info.isSelect
            data.number=num1
            // cartList[i].number++

            localStorage.setItem('cartList', JSON.stringify(cartList))
            // cartList.push(JSON.stringify(localStorage.getItem('goods_info')))
            break
          }
        }
        // data 就是我找到的这个信息
        //data.number++

        // 4-5. 数量添加的时候, 小计价格要改变
        //data.xiaoji = data.number * data.price // 数量 * 单价
      } else {
        // 表示没有这个信息, 直接 push 就可以了
        // push 之前, 象里面添加一个 number 信息为 1
        //info.number = 1

        // 4-5. 多添加一些信息
        //info.xiaoji = info.price // 因为默认是第一个, 小计就是单价
        info.isSelect = true // 默认选中
        cartList.push(info)
        // console.log(ocalStorage.getItem('goods_info'))
      }

      // 在存储到 localStorage 里面
      localStorage.setItem('cartList', JSON.stringify(cartList))
      window.open('./shopping.html')
    })



        //放大镜
        $('.pt-c').mouseenter(function(){
            //显示
            $('.ydfk').css('display','block')
            $('.pt-datu').css('display','block')
        })
        $('.pt-c').mouseleave(function(){
            //显示
            $('.ydfk').css('display','none')
            .css('top',0).css('left',0)
            $('.pt-datu').css('display','none')
        })
        $('.pt-c').mousemove(function(e){
            var event = e || window.event;
		// var x = 鼠标距离页面左侧的距离(看的见的+看不见的) - small(box)距离页面左侧的距离
		//console.log(e)
		//为了鼠标在mask中居中所以x,y都要减去mask的一半
		var x = event.clientX +$(window).scrollLeft()- $('.pt-c').offset().left-$('.ydfk').width()/2;
        var y = event.clientY+$(window).scrollTop() - $('.pt-c').offset().top-$('.ydfk').height()/2;
       
        if(x<0){
			x = 0;
		}
		if(x>$('.pt-c').width()-$('.ydfk').width()){
			x = $('.pt-c').width()-$('.ydfk').width();
		}
		if(y<0){
			y = 0;
		}
		if(y>$('.pt-c').height()-$('.ydfk').height()){
			y = $('.pt-c').height()-$('.ydfk').height();
        }
        //console.log(x,y)
        $('.ydfk').css('left',x+'px')
        $('.ydfk').css('top',y+'px')

        //x/small.offsetWidth = 大图片要偏移的距离/大图的宽度
		var left = x/$('.pt-c').width()*$('.pt-datu>img').width();
		//y/small.offsetHeight = 大图片要偏移的距离/大图的高度
		var top = y/$('.pt-c').height()*$('.pt-datu>img').height();
		
        
        $('.pt-datu>img').css('left',-left+"px")
        $('.pt-datu>img').css('top',-top+"px")
        })


        $('a').prop('href','javascript: ;')
    </script>
</body>

</html>